var XGSDK;(function(XGSDK){var Type;(function(Type){Type[Type["agent"]=0]="agent";Type[Type["h5"]=1]="h5";Type[Type["app"]=2]="app"})(Type||(Type={}));var type=Type.agent;function invite(){switch(type){case Type.agent:window["GS"].invite();break;case Type.h5:parent.postMessage({msg:"xginvite"},"*");break;case Type.app:window.location.href="h5sword://invite";break}}XGSDK.invite=invite;function pay(payInfo){switch(type){case Type.agent:window["GS"].pay(payInfo.uid,payInfo.serverId,payInfo.roleId,{items:payInfo.wareId,txId:payInfo.txId,userdata:payInfo.userdata});break;case Type.h5:parent.postMessage({msg:"xgpay",payInfo:payInfo},"*");break;case Type.app:window.location.href="h5sword://pay?payInfo="+encodeURIComponent(JSON.stringify(payInfo));break}}XGSDK.pay=pay;function logout(){switch(type){case Type.agent:window["GS"].logout(function(response){if(response.status==1){window.location.replace("https://id.vltkh5.zing.vn/logout-game")}});break;case Type.h5:parent.postMessage({msg:"xglogout"},"*");break;case Type.app:window.location.href="h5sword://logout";break}}XGSDK.logout=logout;function onMessage(e){switch(e.data.msg){case"xginit":window["GS"].getLoginStatus(function(response){var frame=document.getElementById("ifr-game");frame.contentWindow.postMessage({msg:"xgloginStatusResponse",status:response.status},"*")});break;case"xglogout":logout();break;case"xgpay":pay(e.data.payInfo);break;case"xgloginStatusResponse":clearTimeout(timer);if(e.data.status=="connected"){clearTimeout(timer)}else{window.location.href="//id.vltkh5.zing.vn/login-game"}break}}var timer;function init(client){if(client){if(getQueryString("ksClient")=="app"){type=Type.app}else{type=Type.h5;window.addEventListener("message",onMessage);parent.postMessage({msg:"xginit"},"*");timer=setTimeout(function(){window.location.reload()},1e3)}}else{type=Type.agent;window.addEventListener("message",onMessage)}}XGSDK.init=init;function getQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null}})(XGSDK||(XGSDK={}));
